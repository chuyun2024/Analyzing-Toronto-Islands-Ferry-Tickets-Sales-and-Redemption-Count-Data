---
title: "Analyzing Toronto Islands Ferry Tickets Sales and Redemption Count Data"
subtitle: ""
author: 
  - Yun Chu
thanks: ""
date: 23 September 2024
date-format: long
abstract: "The paper firstly discussed the background of the dataset, then presented and analyzed the cleaned dataset. In the result section, the relationship between the sales and redemption data, the distribution of redemption count, and the trend of redemption count with respect to time is analyzed. The discussion section comes up with some suggestions to Toronto Islands ferries based on the findings and discuss the limilation of the analysis."
format: pdf
toc: true
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false
library(tidyverse)
library(knitr)
library(scales)
library(dplyr)
```

# Introduction

Ferries to Toronto Island Park is a service that operates all year round. Ferries carry passenger from Jack Layton Ferry Terminal to Center Island, Hanlan's Point and Ward's Island or from the three islands to the terminal (@toronto_ferry_website).

They are popular places to visit for tourists and people who live in Toronto. Most people take the ferries to and from Toronto Islands while others take water taxis. By analyzing the sales and redemption count data of the ferry to Toronto Islands, we can better understand visitor trends to help with maximizing resource allocation and analyze revenue data.

Through identifying peak seasons for ferry usage, it would help understand at what times are the islands most popular. This would inform details about resource allocation and operational planning information for governments. For example, the information could be used to design the departure and returning schedule of the ferry and the number of staff on duty in each season. By examining sales data over time, revenue trends can be identified and thus help assess the financial health of the ferry service and guide pricing strategies.

This paper reveals that the sales and redemption data are highly correlated and is highly likely to have a linear relationship. It also finds that in summer months, the number of redemption is much higher compared with winter months. Moreover, the 95% of redemption is below 16,076 per day.

The remainder of this paper is structured as follows. @sec-data discusses about the features of raw data and the cleaned data, as well as some summary of the cleaned data. @sec-result discusses about the details of investigating the relationship between Sales and Redemption Data through graphs, linear regression and correlation. Besides, the section also presents and analyses the distribution of the redemption count data based on frequency and month.
@sec-discussion elaborates further on the implication and application of the analysis in @sec-result. It also discusses about the weakness of the analysis and the ways to improve.

# Data {#sec-data}

## Raw Data

The data used in this paper is taken from Toronto Open Data and is read into the paper using the opendatatoronto library (Gelfand 2022). The raw data contains the timestamp data per 15 minutes and the sales and redemption count data for each 15-minute time collected from online and POS-kiosk sales(@toronto_ferry_tickets).The it contains data from July 11st, 2023 to September 20, 2024. The data is updated hourly.

The dataset is downloaded, cleaned and analysed using R (@citeR). The following packages are also utilized:

-   tidyverse (@tidyverse)
-   lubridate (@lubridate)
-   dplyr (@dplyr)
-   knitr (@knitr)
-   scales (@scales)


## Cleaned Data

A sample of the cleaned data (@tbl-cleaned_data) and a line plot (@fig-Sales_and_Redemption_vs_Date) showcasing every sales and redemption count data by date are shown below.

```{r, warning=FALSE}
#| label: tbl-cleaned_data
#| echo: false
data <- read_csv("../data/analysis_data/cleaned_data.csv", show_col_types = FALSE)
data2 <- head(data)

kable(data2, col.names = c('Date', 'Sales', 'Redemption'), align = "ccc", 
      caption = "Sample of Cleaned Sales and Redemption Data")
```

```{r, fig.width = 9, fig.height = 5}
#| label: fig-Sales_and_Redemption_vs_Date
#| fig-cap: line plot of sales and redemption data with respect to time
#| echo: false
ggplot(data, aes(x = formatted_date)) +
  geom_line(aes(y = daily_sales_count, color = "Sales"), linewidth = 1, alpha = 0.7) +     
  geom_line(aes(y = daily_redemption_count, color = "Redemption"), linewidth = 1, alpha = 0.7) +
  labs(title = "Sales and Redemption Over Time",                
       x = "Date",                                          
       y = "Count") +                               
  scale_color_manual(name = "Legend", values = c("Sales" = "goldenrod1", "Redemption" = "plum1")) + 
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

From the line graph, we can see that the sales and redemption data is highly overlapped and that the values are much bigger in summer compared with winter.

## Summary of Data

To have a better understanding of the data, the mean sales and redemption counts are calculated in @tbl-mean_sales_and_redemption.
```{r}
#| label: tbl-mean_sales_and_redemption
#| echo: false
#| warning: false
#| message: false
data_means <- 
  data |> 
  summarise( mean_sales = mean(daily_sales_count),
             mean_redemption = mean(daily_redemption_count))
kable(data_means, col.names = c('Mean Sales','Mean Redemption'), align = 'cc', caption = 'Mean Sales and Redemption Count')
```
The mean sales is very close to mean redemption. From both @fig-Sales_and_Redemption_vs_Date and @tbl-mean_sales_and_redemption, the sales and redemption data look very alike. The analysis of the relationship between sales and redemption is done in the next section.

```{r}
#| label: Sorted Data
#| fig-cap: Cleaned data sorted by sales and redemption repectively
#| echo: false
#| warning: false
#| message: false
#| include: false
sorted_sales <- data %>%
  arrange(desc(daily_sales_count))

selected_sales <- sorted_sales %>%
  select(formatted_date, daily_sales_count, daily_redemption_count) 

plot1 <- head(selected_sales, n=10) %>%
  kable(col.names = c('Date', 'Sales', 'Redemption'), 
        align = "ccc", 
        caption = "Cleaned Data Sorted by Sales")

sorted_redemption <- data %>%
  arrange(desc(daily_redemption_count))

selected_redemption <- sorted_redemption %>%
  select(formatted_date, daily_sales_count, daily_redemption_count) 

plot2 <- head(selected_redemption, n= 10) %>%
  kable(col.names = c('Date', 'Sales', 'Redemption'), 
        align = "ccc", 
        caption = "Cleaned Data Sorted by Redemption")
plot1
plot2

```

# Result{#sec-result}


## Investigating the Relationship between the Sales and Redemption Data{#sec-result1}

To investigate the relationship between sales and redemption data directly, we first plot @fig-Sales_vs_Redemption where it describe the relationship between the variables visually.


```{r,fig.width = 6, fig.height = 3}
#| label: fig-Sales_vs_Redemption
#| fig-cap: Relationship betwwen Sales and Redemption
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
ggplot(data, aes(x = daily_sales_count, y = daily_redemption_count)) +
  geom_point() +
  labs(title = "Scatter Plot of Sales vs Redemption",
       x = "Ticket Sales Count",
       y = "Ticket Redemption Count")

```


It is obvious to tell that they have a linear relationship. To further investigate, we do a linear regression with redemption count as the response variable and sales count as the predictor variable. As @tbl-linear_regression_and_correlation_result shows, the R-squared statistic is 0.9882 and the correlation between redemption count and sales count is 0.994. These values indicates that the redemption count and sales count are indeed highly correlated. 

In this paper we'll be mainly focusing on analyzing the redemption count data since it is the direct reflection of the visitor data and using it to analyze revenue is accurate enough since the two variables are higly overlapped and correlated.


```{r}
#| label: tbl-linear_regression_and_correlation_result
#| echo: false
#| warning: false
#| message: false
model <- lm(daily_redemption_count ~ daily_sales_count, data = data)
r_squared <- summary(model)$r.squared
corr_stat <- cor(data$daily_sales_count, data$daily_redemption_count)
summary_table <- data.frame(
  statistic = c("R-Squared", "Correlation"),
  value = c(r_squared, corr_stat)
)
kable(summary_table, col.names = c("Statistics", "Value"), align = 'cc', caption = "R-squared and Correlation Statistic")
```


## Investigating the Frequency of Redemption Count Data

@fig-Daily_Redemption_Histogram shows that for most of the days, the redemption count is below 10,000 times, while the rest of days has redemption count up to 20234 times in one day. For our purpose of using the information to help with resource allocation, monthly data would be sufficient enough so that we can create monthly schedule for staff. Creating daily schedules would be not as feasible and efficient as monthly schedules.

```{r}
#| label: fig-Daily_Redemption_Histogram
#| fig-cap: Histogram of Daily Redemption count data
#| echo: false
#| warning: false
#| message: false
percentile_95 <- quantile(data$daily_redemption_count, 0.95)

ggplot(data, aes(x = daily_redemption_count)) +
  geom_histogram(binwidth = 300, fill = "lightskyblue", color = "steelblue1") +
  labs(title = "Histogram of Daily Redemption Counts",
       x = "Daily Redemption Count",
       y = "Frequency") +
  theme(plot.title = element_text(hjust = 0.5)) +
  annotate("text", x = percentile_95, y = 30, label = paste("95th Percentile:", round(percentile_95, 2)), 
           color = "mediumpurple", vjust = -0.5) +
  geom_vline(xintercept = percentile_95, color = "mediumpurple", linetype = "dashed", size = 1)
```

@fig-Redemption_Over_Month showcases the redemption count over each month. The dividing line in each bar is to indicate each day's redemption count and show how they add up together. It is evident that in Winter months, the redemption counts are very small, while in summer months, the redemption counts are very high. In August 2023, the redemption count is almost 350,000.

## Investigating the Monthly Redemption Data
```{r}
#| label: fig-Redemption_Over_Month
#| fig-cap: Redemption Count of Each Month
#| echo: false
#| warning: false
#| message: false
data <- data %>%
  mutate(year_month = format(formatted_date, "%Y-%m"))

ggplot(data, aes(x = year_month, y = daily_redemption_count)) +
  geom_bar(stat = "identity", fill = "grey93", color = "lightskyblue") +
  labs(title = "Redemption Over Month",                
       x = "Month",                                          
       y = "Redemption Count") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
         plot.title = element_text(hjust = 0.5)) +
  scale_y_continuous(labels = comma)
```

From July to September 2023 and May to September 2024, the monthly redemption count exceeds 100,000 each month. From October 2023 to April 2024, the redemption count is less than 100,000 each month. It would be reasonable to design two schedules for the ferries and assign different number of staff to be on duty based on this threshold.


# Discussion{#sec-discussion}


## Suggestions to adjusting price based on season {#sec-first-point}

From the high correlation and linear relationship between the sales and redemption data, one possible reason might be that the ferry price is flat for all years. If the price is set to be lower in off-peak season, that might help increase revenue in winter while the loss of revenue in summer might not be high.


## Measures government can take on to cope with high-volume season

Based on @fig-Daily_Redemption_Histogram, one measure that Toronto Islands ferries could adapt is that during the peak seasons, integrate the staff schedules to be prepared for large visitor volumes. For example, having some janitors to be on-call in case there is a large amount of people using the ferries service and there's not enough staff to clean the garbage. This also leads to the next discussion point, which is the on-call schedule should be set based on peak season and off-peak season. If it's winter months, preparing the number of staff to cope with more than 20,000 visitors per day is just waste of resources.

## Monthly Schedules based on historical data

from @fig-Redemption_Over_Month, a noticeable difference is the height of the bars between May-September and the rest of the months in a year. Right now, the Toronto Island ferries, already adapt different schedules for summer and winter months to allocate resources efficiently. Taking a closer look at the graph, July and August have much higher redemption count compared with the rest of summer months. Further splitting the schedules might be helpful to better meet visitors' need and avoid wasting resouces.


## Weaknesses and next steps

By examining the linear relationship of redemption and sales data in @sec-result1, the analysis is done using redemption data for simplicity and the representation of the actual visitor volume of the ferries. If we're want to get a better sense of anything related to revenue, analysis with the sales data would be more accurate.

\newpage

\appendix

# Appendix {.unnumbered}

# Additional data details


\newpage

# References
